# .repo/ Directory - Complete Inventory & Catalog

**Generated:** 2026-01-24  
**Purpose:** Comprehensive catalog of the agentic system and governance framework  
**Status:** Complete inventory of all components

---

## Executive Summary

The `.repo/` directory contains a complete **AI-Native Repository Governance Framework** designed to enable safe, effective collaboration between AI agents and human developers. The system includes:

- **8 Policy Documents** - Constitutional rules, principles, quality gates, security baselines
- **Agent Framework** - Machine-readable rules, role definitions, checklists, and prompts
- **30+ Automation Scripts** - Governance verification, validation, and workflow automation
- **21 Templates** - Document templates for PRs, ADRs, waivers, trace logs, and more
- **Task Management System** - Kanban-style workflow (TODO → BACKLOG → ARCHIVE)
- **HITL System** - Human-in-the-loop escalation and tracking
- **Traceability** - Agent logs, trace logs, and evidence tracking

**Total Files:** ~100+ files across 9 major categories

---

## 1. Core Framework Files

**Location:** `.repo/` root  
**Purpose:** Entry points and framework documentation

| File | Size | Purpose | Status |
|------|------|---------|--------|
| `GOVERNANCE.md` | ~7.1KB | Framework entry point and overview | Active |
| `repo.manifest.yaml` | ~2.0KB | **Source of truth** for executable commands | Critical |
| `AGENT.md` | ~800B | Agent guide for this directory | Active |
| `INDEX.md` | ~4.6KB | Directory structure index | Archived |
| `DOCUMENT_MAP.md` | ~9.1KB | Token-optimized document reference system | Archived |
| `CHANGELOG.md` | ~6.3KB | Framework change history | Active |
| `REORGANIZATION_SUMMARY.md` | ~3.5KB | Recent reorganization documentation | Reference |
| `REPO_REORGANIZATION_PLAN.md` | ~4.4KB | Reorganization planning document | Reference |

**Key Features:**
- `repo.manifest.yaml` defines all executable commands (agents MUST read before running commands)
- `constitution.json` and `procedures.json` provide all rules and workflows (replaces DOCUMENT_MAP.md)
- `GOVERNANCE.md` is the human entry point

---

## 2. Policy Documents

**Location:** `.repo/policy/`  
**Purpose:** Authoritative governance rules and standards  
**Count:** 8 policy documents

| File | Purpose | Immutability | Key Content |
|------|---------|--------------|-------------|
| `CONSTITUTION.md` | 8 fundamental articles | **IMMUTABLE** (founder approval only) | Articles 1-8: Authority, Verification, No Guessing, Incremental Delivery, Traceability, Safety, Variation, HITL |
| `PRINCIPLES.md` | Operating principles (P3-P25) | Updateable | 23 operating principles implementing constitutional articles |
| `QUALITY_GATES.md` | Quality standards and merge gates | Updateable | Merge requirements, test coverage, linting, type checking |
| `SECURITY_BASELINE.md` | Security requirements and HITL triggers | Updateable | Security patterns, forbidden code, HITL triggers |
| `BOUNDARIES.md` | Architectural boundaries and import rules | Updateable | Module boundaries, import direction rules, cross-feature requirements |
| `HITL.md` | Human-in-the-loop tracking index | Updateable | Active/archived HITL items table |
| `BESTPR.md` | Repository-specific best practices | Updateable | Repo-specific coding standards |
| `DIAMONDREPO.md` | Diamond repository pattern documentation | Reference | Architectural pattern reference |

**Policy Hierarchy:**
1. **CONSTITUTION** (Layer 1 - Immutable) - 8 articles
2. **PRINCIPLES** (Layer 2 - Updateable) - 23 principles
3. **Quality/Security/Boundaries** (Layer 2 - Updateable) - Specific standards
4. **BESTPR** (Layer 1 - Custom) - Repo-specific

**Critical Rules:**
- Article 3: No Guessing → Mark `<UNKNOWN>` → Create HITL
- Article 6: Safety Before Speed → STOP → ASK → VERIFY → PROCEED
- Article 8: HITL for External Systems (credentials, billing, production)

---

## 3. Agent Framework

**Location:** `.repo/agents/`  
**Purpose:** AI agent rules, roles, checklists, and prompts  
**Count:** 12 files + 2 subdirectories

### Core Agent Files

| File | Purpose | Format | Usage |
|------|---------|--------|-------|
| `rules.json` | **Primary rules source** (machine-readable) | JSON Schema | All agent rules, workflows, policies |
| `constitution.json` | Behavioral governance rules | JSON | All rules, principles, workflows (replaces QUICK_REFERENCE.md) |
| `rules-compact.md` | Compact format (~200 tokens) | Markdown | Token-optimized reference |
| `capabilities.md` | List of all agent capabilities | Markdown | Capability reference |
| `FORMATS.md` | Available format documentation | Markdown | Format specifications |

### Agent Roles

**Location:** `.repo/agents/roles/`  
**Count:** 4 role definitions

| File | Role | Purpose |
|------|------|---------|
| `primary.md` | Primary agent | Main development agent role |
| `secondary.md` | Secondary agent | Supporting agent role |
| `reviewer.md` | Reviewer role | Human reviewer role definition |
| `release.md` | Release role | Human release manager role |

### Agent Checklists

**Location:** `.repo/agents/checklists/`  
**Count:** 3 checklists

| File | Purpose | When to Use |
|------|---------|-------------|
| `change-plan.md` | Change planning checklist | When planning a change |
| `pr-review.md` | PR review checklist | When reviewing/creating PR |
| `incident.md` | Incident response checklist | When handling incidents |

### Agent Prompts

**Location:** `.repo/agents/prompts/`  
**Count:** 2 prompt templates

| File | Purpose | When to Use |
|------|---------|-------------|
| `pr_template.md` | PR prompt template | When creating PR |
| `task_packet.md` | Task packet template | When creating task packets |

**Agent Workflow:**
1. Read `constitution.json` (or `rules.json` for legacy support)
2. Read `.repo/tasks/TODO.md` (current task)
3. Read `.repo/repo.manifest.yaml` (commands)
4. Follow three-pass workflow: Plan → Change → Verify

---

## 4. Automation Scripts

**Location:** `.repo/automation/scripts/`  
**Purpose:** Governance verification, validation, and workflow automation  
**Count:** 30+ scripts (17 JavaScript, 6 Python, 4 Markdown, 3 other)

### Governance Verification

| Script | Language | Purpose | CI Integration |
|--------|----------|---------|----------------|
| `governance-verify.js` | JavaScript | **Canonical** governance verification | ✅ Used in CI |
| `check-framework-compliance.js` | JavaScript | Framework compliance checking | ✅ Used in CI |
| `validate-manifest.js` | JavaScript | Manifest command validation | Reference |

### Validation Scripts

| Script | Language | Purpose |
|--------|----------|---------|
| `validate-agent-trace.js` | JavaScript | Trace log JSON schema validation |
| `validate-agent-context.js` | JavaScript | Context file validation (JSON schema) |
| `validate-evidence.js` | JavaScript | Evidence schema validation |
| `check-boundaries.js` | JavaScript | Architectural boundary enforcement |
| `check-security-patterns.js` | JavaScript | Security pattern scanning |
| `check-artifacts-by-change-type.js` | JavaScript | Artifact requirement checking |

### HITL Management

| Script | Language | Purpose |
|--------|----------|---------|
| `create-hitl-item.py` | Python | Create HITL items from template |
| `sync-hitl-to-pr.py` | Python | Sync HITL status to PR (GitHub API) |

### Task Management

| Script | Language | Purpose |
|--------|----------|---------|
| `promote-task.py` | Python | Promote tasks from BACKLOG to TODO |
| `archive-task.py` | Python | Archive completed tasks |

### Logging & Tracing

| Script | Language | Purpose |
|--------|----------|---------|
| `agent-logger.js` | JavaScript | Agent interaction logging SDK |
| `create-agent-log.py` | Python | Create agent logs |
| `create-trace-log.js` | JavaScript | Create trace logs |

### Context Management

| Script | Language | Purpose |
|--------|----------|---------|
| `generate-agent-context.js` | JavaScript | Generate agent context files |
| `check-stale-context.js` | JavaScript | Check for stale context files |
| `update-context-verified.js` | JavaScript | Update context verification dates |
| `validate-agent-context.js` | JavaScript | Validate context files |

### Metrics & Reporting

| Script | Language | Purpose |
|--------|----------|---------|
| `framework-metrics.js` | JavaScript | Generate framework compliance metrics |
| `generate-index-json.js` | JavaScript | Generate index JSON files |

### Pattern Verification

| Script | Language | Purpose |
|--------|----------|---------|
| `pattern-verification.js` | JavaScript | Verify pattern files |

### Waiver Management

| Script | Language | Purpose |
|--------|----------|---------|
| `manage-waivers.py` | Python | Create, validate, and track waivers |

### CI Integration

**Location:** `.repo/automation/ci/`  
**Count:** 1 CI workflow template

| File | Purpose |
|------|---------|
| `governance-verify.yml` | CI workflow template (reference) |

**Note:** Actual CI integration is in `.github/workflows/ci.yml` (Job 7: Governance Verification)

### Script Dependencies

| File | Purpose |
|------|---------|
| `package.json` | Node.js dependencies (ajv for schema validation) |
| `requirements.txt` | Python dependencies (requests, etc.) |
| `README.md` | Script documentation |
| `STATUS.md` | Script status tracking |
| `SETUP_INSTRUCTIONS.md` | Setup instructions |
| `VERIFICATION.md` | Verification documentation |

**Script Categories:**
- **Governance:** 3 scripts
- **Validation:** 6 scripts
- **HITL:** 2 scripts
- **Task Management:** 2 scripts
- **Logging:** 3 scripts
- **Context:** 4 scripts
- **Metrics:** 2 scripts
- **Patterns:** 1 script
- **Waivers:** 1 script
- **CI:** 1 template

---

## 5. Templates

**Location:** `.repo/templates/`  
**Purpose:** Document templates for governance artifacts  
**Count:** 21 files (11 Markdown, 7 JSON, 2 Python, 1 other)

### Core Templates

| File | Format | Purpose |
|------|--------|---------|
| `PR_TEMPLATE.md` | Markdown | Pull request template |
| `ADR_TEMPLATE.md` | Markdown | Architecture decision record |
| `WAIVER_TEMPLATE.md` | Markdown | Policy waiver template |
| `RFC_TEMPLATE.md` | Markdown | Request for comments |
| `RUNBOOK_TEMPLATE.md` | Markdown | Operations runbook |

### Agent Templates

| File | Format | Purpose |
|------|--------|---------|
| `AGENT_LOG_TEMPLATE.md` | Markdown | Agent log structure |
| `AGENT_TRACE_SCHEMA.json` | JSON Schema | Trace log JSON schema |
| `AGENT_CONTEXT_SCHEMA.json` | JSON Schema | Agent context JSON schema |
| `AGENT_PATTERNS_TEMPLATE.md` | Markdown | Agent patterns template |
| `AGENT_QUICK_REFERENCE_TEMPLATE.md` | Markdown | Quick reference template |

### Evidence & Validation

| File | Format | Purpose |
|------|--------|---------|
| `EVIDENCE_SCHEMA.json` | JSON Schema | Evidence validation schema |

### Template Examples

**Location:** `.repo/templates/examples/`  
**Count:** 8 example files

| File | Format | Purpose |
|------|--------|---------|
| `example_trace_log.json` | JSON | Example trace log |
| `example_hitl_item.md` | Markdown | Example HITL item |
| `example_waiver.md` | Markdown | Example waiver |
| `example_task_packet.json` | JSON | Example task packet |
| `example_task_packet_api_change.json` | JSON | API change task packet example |
| `example_task_packet_cross_module.json` | JSON | Cross-module task packet example |
| `example_test_api_integration.py` | Python | API integration test example |
| `example_test_component.tsx` | TypeScript | Component test example |
| `example_test_viewset.py` | Python | Viewset test example |
| `README.md` | Markdown | Examples documentation |

**Template Usage:**
- Templates define required structure for governance artifacts
- Examples demonstrate correct format
- JSON schemas enable automated validation

---

## 6. Task Management

**Location:** `.repo/tasks/`  
**Purpose:** Kanban-style task workflow  
**Count:** 5 files (4 Markdown, 1 JSON subdirectory)

### Task Files

| File | Purpose | Rule |
|------|---------|------|
| `TODO.md` | Current active tasks | **3-5 tasks at a time, grouped by similar types** |
| `BACKLOG.md` | Prioritized queue | Ordered P0 → P3 |
| `ARCHIVE.md` | Completed tasks | Historical record |
| `README.md` | Task management workflow | Documentation |

### Task Packets

**Location:** `.repo/tasks/packets/`  
**Count:** 1 task packet (example)

| File | Purpose |
|------|---------|
| `TASK-013-packet.json` | Example task packet |

**Task Workflow:**
```
BACKLOG (Queue) → TODO (Active) → ARCHIVE (Done)
```

**Priority Levels:**
- **P0:** Critical (blocking, security, broken CI) - Immediate
- **P1:** High (important features) - This week
- **P2:** Medium (standard features) - This month
- **P3:** Low (nice-to-haves) - When possible

**Task Format:**
- Task ID: `[TASK-XXX]`
- Priority: P0-P3
- Status: Pending | In Progress | Completed
- Acceptance Criteria: Specific, measurable, testable

---

## 7. HITL (Human-In-The-Loop)

**Location:** `.repo/hitl/`  
**Purpose:** Human escalation and tracking  
**Count:** 2 files (1 Markdown, 1 HITL item)

### HITL Files

| File | Purpose |
|------|---------|
| `README.md` | HITL items directory documentation |
| `HITL-0001.md` | Example/active HITL item |

**HITL Index:** `.repo/policy/HITL.md` (tracks active/archived items)

**HITL Triggers:**
- Security/auth/money flows
- External systems (credentials, billing, production)
- Uncertain situations (Article 3: No Guessing)
- Policy waivers
- Cross-module changes (may require ADR)

**HITL Format:**
- ID: `HITL-XXXX` (sequential)
- Category: Security, Architecture, Policy, etc.
- Status: Active, Pending, Completed, Superseded
- Required Actions: Human actions needed
- Evidence Checklist: Verification requirements

---

## 8. Logs & Traces

### Agent Logs

**Location:** `.repo/logs/`  
**Purpose:** Agent interaction logs  
**Count:** 9 log files + README

| File | Purpose |
|------|---------|
| `README.md` | Logs directory documentation |
| `TASK-002-log-20260124-000435.json` | Task-specific log |
| `TASK-003-log-20260124-004450.json` | Task-specific log |
| `TASK-012-log-20260124-005524.json` | Task-specific log |
| `TASK-013-log-20260124-011517.json` | Task-specific log (2 versions) |
| `TASK-013-log-20260124-013223.json` | Task-specific log |
| `TASK-017-log-20260124-055500.json` | Task-specific log |
| `TASK-020-log-20260124-055505.json` | Task-specific log |
| `TASK-073-log-20260124-055509.json` | Task-specific log |

**Log Format:** JSON following `AGENT_LOG_TEMPLATE.md`  
**Naming:** `{TASK-ID}-log-{timestamp}.json`

### Trace Logs

**Location:** `.repo/traces/`  
**Purpose:** Agent trace logs (Plan → Change → Verify)  
**Count:** 9 trace files + README

| File | Purpose |
|------|---------|
| `README.md` | Traces directory documentation |
| `TASK-002-trace-20260124-000457.json` | Task trace log |
| `TASK-003-trace-20260124-004441.json` | Task trace log |
| `TASK-012-trace-20260124-005521.json` | Task trace log |
| `TASK-013-trace-20260124-011512.json` | Task trace log (2 versions) |
| `TASK-013-trace-20260124-013221.json` | Task trace log |
| `TASK-017-trace-20260124-055449.json` | Task trace log |
| `TASK-020-trace-20260124-055453.json` | Task trace log |
| `TASK-073-trace-20260124-055456.json` | Task trace log |

**Trace Format:** JSON following `AGENT_TRACE_SCHEMA.json`  
**Naming:** `{TASK-ID}-trace-{timestamp}.json`

**Trace Log Contents:**
- Intent: What the agent was trying to accomplish
- Files: Which files were modified
- Commands: Verification commands run
- Evidence: Proof of verification
- HITL: HITL items created
- Unknowns: Things marked as UNKNOWN

**Required For:**
- Feature additions
- Bug fixes
- Refactoring
- Security changes
- API changes
- Schema changes

**Not Required For:**
- Documentation-only changes
- Comment-only changes
- Whitespace-only changes

---

## 9. Examples

**Location:** `.repo/examples/`  
**Purpose:** Example files demonstrating correct formats  
**Count:** 5 files

| File | Format | Purpose |
|------|--------|---------|
| `example_trace_log.json` | JSON | Example trace log format |
| `example_hitl_item.md` | Markdown | Example HITL item format |
| `example_waiver.md` | Markdown | Example waiver format |
| `example_task_packet.json` | JSON | Example task packet format |
| `README.md` | Markdown | Examples documentation |

**Note:** Additional examples are in `.repo/templates/examples/` (8 files)

---

## System Architecture

### Layer Model

The framework uses a 3-layer update model:

1. **Layer 1 (CUSTOM):** Repository-specific content
   - `repo.manifest.yaml` - Commands
   - `policy/HITL.md` - HITL items
   - `policy/BESTPR.md` - Repo-specific practices

2. **Layer 2 (UPDATEABLE):** Framework-provided but customizable
   - `policy/PRINCIPLES.md` - Operating principles
   - `policy/QUALITY_GATES.md` - Quality standards
   - `policy/SECURITY_BASELINE.md` - Security rules
   - `policy/BOUNDARIES.md` - Architectural boundaries

3. **Layer 3 (IMMUTABLE):** Core framework structure
   - `policy/CONSTITUTION.md` - 8 fundamental articles
   - Framework directory structure
   - Template schemas

### Workflow Integration

**Agent Workflow:**
1. Read `TODO.md` (current task)
2. Read `repo.manifest.yaml` (commands)
3. Read `policy/constitution.json` (rules)
4. Follow three-pass workflow:
   - **Pass 1 (Plan):** Create task packet, plan changes
   - **Pass 2 (Change):** Make code changes, create trace log
   - **Pass 3 (Verify):** Run verification commands, add evidence

**CI Integration:**
- GitHub Actions workflow (`.github/workflows/ci.yml`)
- Job 7: Governance Verification
- Automatic HITL sync on PRs
- Governance verification blocks merge on hard failures

**Local Integration:**
- Makefile target: `make check-governance`
- Pre-commit hook: Non-blocking governance checks
- npm scripts: `check:governance`, `check:compliance`

---

## File Statistics

### By Category

| Category | File Count | Subdirectories |
|----------|------------|----------------|
| Core Framework | 8 | 0 |
| Policy | 8 | 0 |
| Agent Framework | 12 | 2 (roles, checklists, prompts) |
| Automation | 30+ | 1 (ci) |
| Templates | 21 | 1 (examples) |
| Task Management | 5 | 1 (packets) |
| HITL | 2 | 0 |
| Logs | 9 | 0 |
| Traces | 9 | 0 |
| Examples | 5 | 0 |
| **Total** | **~100+** | **5** |

### By File Type

| Type | Count | Examples |
|------|-------|-----------|
| Markdown | ~50 | Documentation, templates, policies |
| JavaScript | 17 | Automation scripts, validation |
| Python | 6 | Task management, HITL, logging |
| JSON | ~15 | Schemas, logs, traces, packets |
| YAML | 2 | Manifest, CI workflows |
| Shell | 1 | Setup scripts |

---

## Key Entry Points

### For AI Agents

1. **Primary:** `AGENTS.json` (root) - Structured JSON entry point
2. **Alternative:** `AGENTS.md` (root) - Human-readable entry point
3. **Quick Start:**
   - Read `.repo/tasks/TODO.md` (current task)
   - Read `.repo/repo.manifest.yaml` (commands)
   - Read `.repo/policy/constitution.json` (rules)

### For Humans

1. **Start Here:** `.repo/GOVERNANCE.md` - Framework overview
2. **Policy:** `.repo/policy/CONSTITUTION.md` - 8 fundamental articles
3. **Rules:** `.repo/policy/constitution.json` - All behavioral rules
4. **Procedures:** `.repo/policy/procedures.json` - How-to instructions

### For Reviewers

1. **HITL Items:** `.repo/policy/HITL.md` - Active items
2. **Quality Gates:** `.repo/policy/QUALITY_GATES.md` - Merge requirements
3. **Trace Logs:** `.repo/traces/` - Verification evidence

---

## Critical Rules Summary

### Article 3: No Guessing
- If unknown → Mark `<UNKNOWN>` → Create HITL → Stop work

### Article 6: Safety Before Speed
- Risky changes → STOP → ASK (HITL) → VERIFY → PROCEED

### Article 8: HITL for External Systems
- Credentials, billing, production = always HITL

### Command Manifest
- **NEVER guess commands** - Always read `repo.manifest.yaml` first
- If command unknown → Set `<UNKNOWN>` → Create HITL

### Traceability
- Every change must link to task in `TODO.md`
- Trace logs required for all non-documentation changes
- Evidence required for verification

---

## Maintenance Notes

### Regular Reviews
- **HITL Items:** Weekly (or as they come in)
- **Waivers:** Monthly (check for expirations)
- **Manifest:** When build/test commands change
- **Policies:** Only when necessary (follow Layer rules)

### Recent Changes
- **2026-01-23:** Directory reorganization, entry point optimization
- **2026-01-23:** Framework enhancements (CI integration, automation)
- **2026-01-24:** Documentation structure reorganization

### Dependencies
- **Node.js:** Required for JavaScript automation scripts
- **Python 3.6+:** Required for Python automation scripts
- **ajv:** JSON schema validation (npm install in scripts/)
- **requests:** Python HTTP library (pip install -r requirements.txt)

---

## Related Documentation

- **Root `AGENTS.json`:** Primary agent entry point
- **Root `AGENTS.md`:** Human-readable agent entry point
- **Root `docs/`:** Comprehensive documentation structure
- **Root `.github/workflows/ci.yml`:** CI integration (Job 7)

---

**End of Catalog**
