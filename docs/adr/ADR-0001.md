# ADR-0001: Allow apps/api routes to depend on feature data layers

**Status:** Accepted
**Date:** 2026-01-24
**Context:** TASK-013 requires refactoring apps/api to use feature data layers instead of local storage.

## Context

apps/api currently implements business logic directly in route handlers and the in-memory
storage layer. TASK-013 requires moving that logic into feature data layers housed under
packages/features to align with the documented architecture.

## Decision Drivers

- Enforce architecture boundaries by keeping business logic in feature packages.
- Make apps/api a thin transport layer that delegates to feature data layers.
- Enable reuse of feature logic across client and server implementations.

## Considered Options

### Option 1: Keep business logic in apps/api
- Pros: No new imports or new modules.
- Cons: Continues boundary violations and duplicates logic outside feature packages.

### Option 2: Move feature logic into packages/features/*/data (Chosen)
- Pros: Aligns with architecture rules and reduces app-level logic.
- Cons: Introduces explicit dependency from apps/api to feature data layers.

## Decision

Adopt Option 2: apps/api will call feature data layers in packages/features/*/data.
This keeps business logic with the feature and establishes apps/api as a thin API
adapter.

## Consequences

### Positive
- Business logic is consolidated inside feature packages.
- API routes become smaller and easier to maintain.

### Negative
- apps/api must now depend on feature package imports.
- Requires continued governance checks to prevent cross-feature coupling.

## Modules Affected

- apps/api (routes/storage)
- packages/features/notes/data

## Boundary Impact

apps/api now depends on packages/features/notes/data. This is an explicit, documented
boundary exception to allow API routes to access feature data layers without re-implementing
business logic.

## Migration Notes

Start with notes as a proof-of-concept, then expand to other features during TASK-013/TASK-014.

## HITL Items

- None

## Notes

This ADR accompanies the initial notes data layer refactor.
